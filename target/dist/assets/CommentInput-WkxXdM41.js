const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CheckIdentityModal-BUwgSOBK.js","assets/config-CKXj5qII.js","assets/ClassicInputText-DAR8Tgsp.js","assets/index.js","assets/index.css","assets/ClassicInputText-BffzFYCu.css","assets/RecaptchaModal-5a-viNyC.js","assets/ClassicLoading-Bf3Fy18F.js","assets/ClassicSpinner-CcbqjM9h.js","assets/ClassicSpinner-DKas6cj3.css","assets/ClassicModal-mpJgF1dy.js","assets/ClassicModal-D0ckngeT.css","assets/CommentStore-DzAJcgPT.js","assets/CommentName-02wvAvBk.js","assets/MessageModal-C61zQp-M.js","assets/ClassicEmojiPicker-Cz2bm3Tf.js","assets/ClassicEmojiPicker-Bol1fzP9.css","assets/ClassicContentEditable-CLMCnFKf.js","assets/ClassicContentEditable-DT6EP8vb.css"])))=>i.map(i=>d[i]);
import{d as E,L as I,m as d,H as A,D as T,p as w,q as a,v as i,_ as k,r as s,o as n,c as p,e as l,i as m,g as u,f as r,z as $,t as c}from"./index.js";import{C as M}from"./config-CKXj5qII.js";import{u as V}from"./CommentStore-DzAJcgPT.js";const g=a(()=>i(()=>import("./CheckIdentityModal-BUwgSOBK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),_=a(()=>i(()=>import("./CommentName-02wvAvBk.js"),__vite__mapDeps([13,1,3,4,12]))),b=a(()=>i(()=>import("./MessageModal-C61zQp-M.js"),__vite__mapDeps([14,10,3,4,11,7,8,9]))),P=a(()=>i(()=>import("./ClassicEmojiPicker-Cz2bm3Tf.js"),__vite__mapDeps([15,3,4,16]))),S=a(()=>i(()=>import("./ClassicContentEditable-CLMCnFKf.js"),__vite__mapDeps([17,3,4,18]))),j=E({name:"CommentInput",components:{CheckIdentityModal:g,MessageModal:b,ClassicEmojiPicker:P,ClassicContentEditable:S,CommentName:_},mixins:[I],props:{podcast:{default:void 0,type:Object},focus:{default:!1,type:Boolean},inAnswerComment:{default:void 0,type:Object}},emits:["cancelAction","newComment"],data(){return{newComment:"",maxComment:M.MAX_COMMENT,isTextareaActive:!1,isCheckIdentity:!1,postError:!1}},computed:{...d(A,["playerPodcast","playerLive","playerElapsed","playerTotal"]),...d(V,["commentUser"]),...d(T,["authOrgaId"]),commentTooLong(){return this.countComment<=this.maxComment},countComment(){return this.newComment.length},placeholder(){return this.inAnswerComment?.commentId?this.$t("Answer a comment"):this.$t("Write a comment")}},watch:{focus(){this.$refs.textarea.focus()}},methods:{addEmojiSelected(e){this.newComment+=e},requestToSend(){this.commentUser?.name?this.postComment():this.isCheckIdentity=!0},cancelAction(){this.newComment="",this.isTextareaActive=!1,this.$emit("cancelAction")},async postComment(){const e={answerTo:this.inAnswerComment?.commentId,content:this.newComment.trim(),name:this.commentUser?.name??"",podcastId:this.podcast?.podcastId??this.inAnswerComment?.podcastId??0,uuid:this.commentUser?.uuid??"",timeline:this.defineTimelineValue()};try{const t=await w.postData({api:2,path:"comment/",dataToSend:e,isNotAuth:this.authOrgaId===void 0});this.$emit("newComment",t),this.newComment="",this.isTextareaActive=!1}catch{this.postError=!0}this.isCheckIdentity=!1},defineTimelineValue(){let e=0;return this.podcast!==void 0&&(this.playerPodcast?.podcastId===this.podcast.podcastId||this.playerLive?.podcastId===this.podcast.podcastId)&&(e=Math.round(this.playerElapsed*this.playerTotal),this.podcast.duration&&this.playerPodcast&&(e=Math.round(e-(this.playerTotal-this.podcast.duration/1e3)))),e<0?0:e}}}),L={class:"d-flex flex-column comment-input-container mt-3"},O={key:1,class:"d-flex justify-content-between mt-1"},D={class:"d-flex ms-auto"},N=["disabled"];function R(e,t,U,B,q,z){const C=s("CommentName"),h=s("ClassicContentEditable"),f=s("ClassicEmojiPicker"),y=s("CheckIdentityModal"),v=s("MessageModal");return n(),p("div",L,[e.commentUser?.name?(n(),l(C,{key:0})):m("",!0),u(h,{ref:"textarea",modelValue:e.newComment,"onUpdate:modelValue":t[0]||(t[0]=o=>e.newComment=o),class:"comment-input",placeholder:e.placeholder,onFocus:t[1]||(t[1]=o=>e.isTextareaActive=!0)},null,8,["modelValue","placeholder"]),e.isTextareaActive?(n(),p("div",O,[u(f,{"popover-relative-class":"page-element",onEmojiSelected:e.addEmojiSelected},null,8,["onEmojiSelected"]),r("div",D,[r("p",{class:$(["d-flex justify-content-end h6 me-3",{"text-danger":!e.commentTooLong}])},c(e.countComment+" / "+e.maxComment),3),r("button",{class:"btn me-2",onMousedown:t[2]||(t[2]=(...o)=>e.cancelAction&&e.cancelAction(...o))},c(e.$t("Cancel")),33),r("button",{class:"btn btn-primary",disabled:e.countComment===0||!e.commentTooLong,onMousedown:t[3]||(t[3]=(...o)=>e.requestToSend&&e.requestToSend(...o))},c(e.placeholder),41,N)])])):m("",!0),e.isCheckIdentity?(n(),l(y,{key:2,onValidate:e.postComment,onClose:t[4]||(t[4]=o=>e.isCheckIdentity=!1)},null,8,["onValidate"])):m("",!0),e.postError?(n(),l(v,{key:3,validatetext:e.$t("Close"),title:e.$t("Error"),message:e.$t("Error occurs while post your comment..."),onClose:t[5]||(t[5]=o=>e.postError=!1),onValidate:t[6]||(t[6]=o=>e.postError=!1)},null,8,["validatetext","title","message"])):m("",!0)])}const X=k(j,[["render",R]]);export{X as default};
