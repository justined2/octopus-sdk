import{d,k as m,m as h,D as g,n as c,a7 as u,p,_ as f,r as O,x as y,o as S,e as w,I as D,w as I,f as s,y as C,t as v,i as $}from"./index.js";import{s as B}from"./selenium-CamdCoc1.js";import{C as k}from"./ClassicMultiselect-C-Xf0Kt3.js";function M(e){return{imageUrl:"/img/emptypodcast.webp",id:"",name:e}}const b=d({components:{ClassicMultiselect:k},mixins:[B,m],props:{defaultanswer:{default:"",type:String},orgaIdSelected:{default:void 0,type:String},reset:{default:!1,type:Boolean},width:{default:"100%",type:String},isImage:{default:!0,type:Boolean},inModal:{default:!1,type:Boolean},noDeselect:{default:!0,type:Boolean}},emits:["selected"],data(){return{maxElement:50,organisationChosen:void 0,initLoaded:!1}},computed:{...h(g,["authOrganisation","authOrgaId"]),getDefaultOrganisation(){if(this.defaultanswer!=="")return M(this.defaultanswer)},myOrganisation(){if(this.authOrgaId)return{...this.authOrganisation,name:`${this.$t("Edit my organisation")} (${this.authOrganisation.name})`}}},watch:{orgaIdSelected:{immediate:!0,handler(){!this.initLoaded&&this.orgaIdSelected&&this.fetchOrganisation()}},reset(){this.organisationChosen=this.getDefaultOrganisation}},created(){this.organisationChosen=this.getDefaultOrganisation},methods:{...c(u,["getOrgaData"]),async onSearchOrganisation(e){const n=await p.fetchData({api:0,path:"organisation/search",parameters:{query:e,first:0,size:this.maxElement}});let t=n.result.filter(a=>a!==null);if(this.getDefaultOrganisation&&t.unshift(this.getDefaultOrganisation),this.myOrganisation)if(e===void 0)t=t.filter(a=>a.id!==this.authOrgaId),t.splice(1,0,this.myOrganisation);else{const a=t.findIndex(o=>o.id===this.authOrgaId);a&&(t[a]=this.myOrganisation)}this.$refs.selectOrganisation.afterSearch(t,n.count)},async fetchOrganisation(){this.organisationChosen=await this.getOrgaData(this.orgaIdSelected??""),this.initLoaded=!0}}}),E=["data-selenium"],L=["alt"];function x(e,n,t,a,o,z){const r=O("ClassicMultiselect"),l=y("lazy");return!e.orgaIdSelected||e.initLoaded?(S(),w(r,{key:0,id:"organisation-chooser",ref:"selectOrganisation","option-label":"name",label:e.$t("select productor"),"max-element":e.maxElement,width:e.width,"in-modal":e.inModal,"option-chosen":e.organisationChosen,"option-custom-templating":"optionTemplating","option-selected-custom-templating":"optionTemplating","no-deselect":e.noDeselect,onOnSearch:e.onSearchOrganisation,onSelected:n[0]||(n[0]=i=>e.$emit("selected",i))},D({_:2},[e.isImage?{name:"optionTemplating",fn:I(({option:i})=>[s("div",{class:"d-flex align-items-center","data-selenium":"organisation-chooser-"+e.seleniumFormat(i.name)},[C(s("img",{width:"32",height:"32",class:"me-2",alt:i.name},null,8,L),[[l,e.proxyImageUrl(i.imageUrl,"32")]]),s("span",null,v(i.name),1)],8,E)]),key:"0"}:void 0]),1032,["label","max-element","width","in-modal","option-chosen","no-deselect","onOnSearch"])):$("",!0)}const U=f(b,[["render",x]]);export{U as default};
