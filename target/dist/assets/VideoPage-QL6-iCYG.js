const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PlayerVideoDigiteka-BBfbS-eI.js","assets/SnackBar-BYGi5e7s.js","assets/index.js","assets/index.css","assets/SnackBar-BAfrY8QD.css","assets/PlayerVideoDigiteka-B4FRf7rY.css","assets/PlayerVideoHls-Ba2B4-T6.js","assets/PlayerVideoHls-BFO_QzTq.css","assets/CommentSection-vHP3z2bv.js","assets/CommentStore-DzAJcgPT.js","assets/VideoModuleBox-BtFIrLTW.js","assets/displayMethods-CzaGbBDz.js","assets/PodcastRawTranscript-DgP4GALl.js","assets/ClassicLoading-Bf3Fy18F.js","assets/ClassicSpinner-CcbqjM9h.js","assets/ClassicSpinner-DKas6cj3.css","assets/PodcastRawTranscript-DQq6SeBH.css","assets/CountdownOctopus-BDr2ljZt.js","assets/countdown-Cu28gV8a.js","assets/CountdownOctopus-Cmv3ZZFP.css"])))=>i.map(i=>d[i]);
import{d as E,j as w,m as h,a as L,D as k,l as O,n as C,H as N,p as g,q as r,v as d,_ as $,r as o,o as t,c as a,F as I,g as i,w as c,f as l,h as y,t as m,e as p,i as n,I as A,b as B}from"./index.js";import U from"./ClassicLoading-Bf3Fy18F.js";import{C as G}from"./ClassicNav-D0TBoB16.js";import{p as H}from"./podcastView-CNJ9XSY0.js";import{u as F}from"./CommentStore-DzAJcgPT.js";import"./ClassicSpinner-CcbqjM9h.js";const q=r(()=>d(()=>import("./PlayerVideoDigiteka-BBfbS-eI.js"),__vite__mapDeps([0,1,2,3,4,5]))),M=r(()=>d(()=>import("./PlayerVideoHls-Ba2B4-T6.js"),__vite__mapDeps([6,2,3,7]))),Y=r(()=>d(()=>import("./CommentSection-vHP3z2bv.js"),__vite__mapDeps([8,2,3,9]))),j=r(()=>d(()=>import("./VideoModuleBox-BtFIrLTW.js"),__vite__mapDeps([10,2,3,11,12,13,14,15,16]))),z=r(()=>d(()=>import("./CountdownOctopus-BDr2ljZt.js"),__vite__mapDeps([17,18,2,3,19]))),J=E({name:"VideoPage",components:{ClassicLoading:U,PlayerVideoDigiteka:q,ClassicNav:G,CommentSection:Y,VideoModuleBox:j,PlayerVideoHls:M,CountdownOctopus:z},mixins:[w,H],props:{podcastId:{default:0,type:Number}},data(){return{loaded:!1,podcast:void 0,error:!1,activeTab:0,configPodcast:void 0,podcastConference:void 0,intervalStatusConference:void 0}},computed:{...h(L,["filterOrgaId"]),...h(k,["authOrgaId"]),...h(O,["hlsUrl"]),videoId(){return this.podcast?.video?.videoId},tabs(){return this.canPostComment?[this.$t("Information"),this.$t("Comments")]:[]},canPostComment(){return this.getCanPostComment(this.configPodcast,this.podcast,this.authOrgaId!==void 0)},recordingLive(){return this.podcastConference!==void 0&&this.podcastConference.conferenceId!==-1&&(this.podcastConference.status==="RECORDING"||this.podcastConference.status==="PENDING")},hlsUrl(){return!this.recordingLive||!this.podcastConference?"":`${this.hlsUrl}live/video_dev.${this.podcastConference.conferenceId}/index.m3u8`},overrideText(){if(this.podcastConference?.status==="PUBLISHING")return this.$t("In the process of being published")}},watch:{podcastId:{immediate:!0,async handler(){await this.getPodcastDetails(),this.podcast&&(this.initCommentUser(),this.configPodcast=await this.getCommentsConfig(this.podcast))}}},unmounted(){clearInterval(this.intervalStatusConference)},methods:{...C(N,["playerPlay"]),...C(F,["getCommentsConfig","getCanPostComment","initCommentUser"]),async getPodcastDetails(){this.loaded=!1,this.error=!1;try{this.podcast=await g.fetchData({api:0,path:"podcast/"+this.podcastId}),document.title=this.podcast.title;const e=this.podcast.organisation,s=e.privacy!=="PUBLIC"&&this.filterOrgaId!==e.id&&this.$route.query.productor!==e.id,f=(!this.podcast.availability.visibility||!["READY_TO_RECORD","READY","PROCESSING"].includes(this.podcast.processingStatus??"")||!this.podcast.valid)&&!this.editRight;s||f?this.error=!0:this.podcast.conferenceId&&(await this.fetchConferenceStatus(),this.intervalStatusConference=setInterval(()=>{this.fetchConferenceStatus()},3e3),this.playerPlay({...this.podcast,conferenceId:this.podcast.conferenceId},!0))}catch(e){this.handle403(e),this.error=!0}this.loaded=!0},async fetchConferenceStatus(){if(!this.podcast?.conferenceId)return;const e=await g.fetchData({api:9,path:"conference/info/"+this.podcast.conferenceId});this.podcastConference={...e,conferenceId:this.podcast.conferenceId,title:""},e.status==="DEBRIEFING"&&clearInterval(this.intervalStatusConference)}}}),K={class:"page-box"},Q={key:0,class:"d-flex video-page-container"},W={class:"w-70-responsive"},X={key:1,class:"d-flex flex-column align-items-center flex-grow-1 blue-bg p-3"},Z={class:"w-30-responsive info-video-container"},x={class:"d-flex flex-column flex-grow-1 w-100"},ee={key:1,class:"text-center text-danger h3"};function te(e,s,f,oe,se,ae){const _=o("router-link"),P=o("PlayerVideoHls"),b=o("CountdownOctopus"),S=o("PlayerVideoDigiteka"),v=o("VideoModuleBox"),V=o("CommentSection"),R=o("ClassicNav"),T=o("ClassicLoading");return t(),a("div",K,[e.loaded&&!e.error?(t(),a(I,{key:0},[i(_,{to:{name:"podcast",params:{podcastId:e.podcastId},query:{productor:e.filterOrgaId}},class:"mt-3 mb-3 width-fit-content"},{default:c(()=>[s[1]||(s[1]=l("span",{class:"saooti-left"},null,-1)),y(m(e.$t("Episode page")),1)]),_:1},8,["to"]),e.videoId||e.isLiveReadyToRecord?(t(),a("div",Q,[l("div",W,[e.isLiveReadyToRecord?(t(),a(I,{key:0},[e.recordingLive?(t(),p(P,{key:0,"hls-url":e.hlsUrl,responsive:!0},null,8,["hls-url"])):n("",!0),e.isCounter||e.overrideText?(t(),a("div",X,[i(b,{"time-remaining":e.timeRemaining,"override-text":e.overrideText},null,8,["time-remaining","override-text"])])):n("",!0)],64)):(t(),p(S,{key:1,"video-id":e.videoId,responsive:!0},null,8,["video-id"]))]),l("div",Z,[l("div",x,[e.tabs.length?(t(),p(R,{key:0,activeTab:e.activeTab,"onUpdate:activeTab":s[0]||(s[0]=u=>e.activeTab=u),"tab-number":e.tabs.length,transparent:!0},A({tab0:c(()=>[i(v,{podcast:e.podcast,date:e.date,duration:e.duration},null,8,["podcast","date","duration"])]),tab1:c(()=>[i(V,{podcast:e.podcast,class:"module-box-transparent"},null,8,["podcast"])]),_:2},[B(e.tabs,(u,D)=>({name:D,fn:c(()=>[y(m(u),1)])}))]),1032,["activeTab","tab-number"])):(t(),p(v,{key:1,class:"p-2 video-module-box",podcast:e.podcast,date:e.date,duration:e.duration},null,8,["podcast","date","duration"]))])])])):n("",!0)],64)):n("",!0),!e.error&&!e.videoId&&!e.isLiveReadyToRecord?(t(),a("div",ee,m(e.$t("The episode does not have an associated video")),1)):n("",!0),i(T,{"loading-text":e.loaded?void 0:e.$t("Loading content ..."),"error-text":e.error?e.$t("This episode is not available for (re)listening"):void 0},null,8,["loading-text","error-text"])])}const pe=$(J,[["render",te]]);export{pe as default};
