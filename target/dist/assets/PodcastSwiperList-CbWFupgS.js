import{d as S,m as v,a as c,n as R,_ as P,r as l,o as a,c as h,f as o,t as b,z as n,i as s,B as C,e as I,w as q,h as A,p as w,K as k,g as y}from"./index.js";import{P as N}from"./PodcastItem-BYhh4qWG.js";import T from"./ClassicLoading-Bf3Fy18F.js";import{S as B}from"./SwiperList-D-QuBtDV.js";import"./orgaComputed-ovvKvHgW.js";import"./PodcastImage-jptmSDc7.js";import"./PodcastPlayButton-DEKHY6Ml.js";import"./ClassicSpinner-CcbqjM9h.js";import"./dom-BVfCmWpy.js";const L=S({name:"PodcastInlineListTemplate",components:{},props:{displayArrow:{default:!0,type:Boolean},previousAvailable:{default:!1,type:Boolean},nextAvailable:{default:!1,type:Boolean},popularSort:{default:!1,type:Boolean},buttonText:{default:void 0,type:String},buttonPlus:{default:!1,type:Boolean},title:{default:"",type:String},href:{default:void 0,type:String},iabId:{default:void 0,type:Number},rubriqueId:{default:()=>[],type:Array},noRubriquageId:{default:()=>[],type:Array},podcastId:{default:void 0,type:Number}},emits:["sortChrono","sortPopular","displayPrevious","displayNext"],data(){return{}},computed:{...v(c,["filterOrgaId","filterRubrique","filterIab","filterRubriquage"]),rubriqueQueryParam(){if(this.filterRubrique?.length)return this.filterRubrique.map(t=>t.rubriquageId+":"+t.rubriqueId).join()},refTo(){return this.href?this.href:this.iabId?{name:"category",params:{iabId:this.iabId},query:{productor:this.filterOrgaId}}:{name:"podcasts",query:{productor:this.filterOrgaId,iabId:this.filterIab?.id,rubriquesId:this.rubriqueQueryParam}}}},methods:{...R(c,["filterUpdateRubrique"]),sortChrono(){this.$emit("sortChrono")},sortPopular(){this.$emit("sortPopular")},displayPrevious(){this.$emit("displayPrevious")},displayNext(){this.$emit("displayNext")},handleSeeMoreButton(t){if(!this.rubriqueId||this.rubriqueId.length===0||this.noRubriquageId.length)return;t.preventDefault();const e=this.rubriqueId.at(-1);let d={rubriquageId:0,rubriqueId:e,nameRubriquage:"",nameRubrique:""};if(this.filterRubriquage.length)for(let i=0,r=this.filterRubriquage.length;i<r;i++){const p=this.filterRubriquage[i].rubriques.find(g=>g.rubriqueId===e);if(p){d={rubriquageId:this.filterRubriquage[i].rubriquageId??0,rubriqueId:e,nameRubriquage:this.filterRubriquage[i].title,nameRubrique:p.name};break}}const u=Array.from(this.filterRubrique);u.push(d),this.filterUpdateRubrique(u);const f=this.$route.query,m=u.map(i=>i.rubriquageId+":"+i.rubriqueId).join();this.$router.push({name:"podcasts",query:{...f,rubriquesId:m}})}}}),O={class:"podcast-inline-container"},D={class:"mb-0"},j={key:0,class:"d-flex justify-content-between"},V={class:"d-flex"},M={key:0,class:"hide-phone"},z=["title"],E=["title"],U={key:0,class:"ms-1 saooti-more"};function F(t,e,d,u,f,m){const i=l("router-link");return a(),h("div",O,[o("div",{class:n(["d-flex align-items-center",t.podcastId?"mb-4":"mb-2"])},[o("h2",D,b(t.title),1)],2),t.podcastId?s("",!0):(a(),h("div",j,[o("div",V,[o("button",{class:n(["btn btn-underline",{active:!t.popularSort}]),onClick:e[0]||(e[0]=r=>t.sortChrono())},b(t.$t("Last added")),3),o("button",{class:n(["btn btn-underline",{active:t.popularSort}]),onClick:e[1]||(e[1]=r=>t.sortPopular())},b(t.$t("Most popular")),3)]),t.displayArrow?(a(),h("div",M,[o("button",{class:n(["btn admin-button m-1 saooti-left",{disabled:!t.previousAvailable}]),title:t.$t("Display previous"),onClick:e[2]||(e[2]=r=>t.displayPrevious())},null,10,z),o("button",{class:n(["btn admin-button m-1 saooti-right",{disabled:!t.nextAvailable}]),title:t.$t("Display next"),onClick:e[3]||(e[3]=r=>t.displayNext())},null,10,E)])):s("",!0)])),C(t.$slots,"list-inline"),t.buttonText?(a(),I(i,{key:1,class:"btn btn-primary align-self-center width-fit-content m-4",to:t.refTo,onClick:t.handleSeeMoreButton},{default:q(()=>[A(b(t.buttonText)+" ",1),t.buttonPlus?(a(),h("div",U)):s("",!0)]),_:1},8,["to","onClick"])):s("",!0)])}const Q=P(L,[["render",F]]),Y=S({name:"PodcastSwiperList",components:{PodcastInlineListTemplate:Q,PodcastItem:N,ClassicLoading:T,SwiperList:B},props:{organisationId:{default:()=>[],type:Array},emissionId:{default:void 0,type:Number},iabId:{default:void 0,type:Number},title:{default:"",type:String},href:{default:void 0,type:String},buttonText:{default:void 0,type:String},isArrow:{default:!1,type:Boolean},requirePopularSort:{default:void 0,type:Boolean},buttonPlus:{default:!1,type:Boolean},rubriqueId:{default:()=>[],type:Array},rubriquageId:{default:()=>[],type:Array},noRubriquageId:{default:()=>[],type:Array},query:{default:void 0,type:String},lastThreeMonths:{default:!1,type:Boolean}},emits:["update:isArrow"],data(){return{loading:!0,popularSort:!1,allPodcasts:[]}},computed:{...v(c,["filterOrgaId"]),organisation(){return this.organisationId.length?this.organisationId:this.filterOrgaId?[this.filterOrgaId]:[]},watchVariable(){return`${this.emissionId}|${this.organisationId}|${this.filterOrgaId}|${this.iabId}|${this.rubriqueId}|${this.rubriquageId}|${this.query}`}},watch:{watchVariable(){this.fetchNext()}},created(){this.requirePopularSort!==void 0&&(this.popularSort=this.requirePopularSort),this.isArrow!==void 0&&this.$emit("update:isArrow",!0)},mounted(){this.fetchNext()},methods:{async fetchNext(){const t=await w.fetchData({api:0,path:"podcast/search",parameters:{first:0,size:10,organisationId:this.organisation,emissionId:this.emissionId,iabId:this.iabId,rubriqueId:this.rubriqueId.length?this.rubriqueId:void 0,rubriquageId:this.rubriquageId.length?this.rubriquageId:void 0,noRubriquageId:this.noRubriquageId.length?this.noRubriquageId:void 0,sort:this.popularSort?"POPULARITY":"DATE",query:this.query,includeStatus:["READY","PROCESSING"],after:this.popularSort&&this.lastThreeMonths?k().subtract(3,"months").toISOString():void 0},specialTreatement:!0});this.loading=!0,this.allPodcasts=t.result.filter(e=>e!==null),this.loading=!1},sortPopular(){this.popularSort||(this.popularSort=!0,this.fetchNext())},sortChrono(){this.popularSort&&(this.popularSort=!1,this.fetchNext())}}});function G(t,e,d,u,f,m){const i=l("ClassicLoading"),r=l("PodcastItem"),p=l("SwiperList"),g=l("PodcastInlineListTemplate");return t.loading||!t.loading&&t.allPodcasts.length!==0?(a(),I(g,{key:0,"display-arrow":!1,"popular-sort":t.popularSort,"button-text":t.buttonText,"button-plus":t.buttonPlus,title:t.title,href:t.href,"iab-id":t.iabId,"rubrique-id":t.rubriqueId,"no-rubriquage-id":t.noRubriquageId,onSortChrono:t.sortChrono,onSortPopular:t.sortPopular},{"list-inline":q(()=>[y(i,{class:"loading-size","loading-text":t.loading?t.$t("Loading podcasts ..."):void 0},null,8,["loading-text"]),t.loading?s("",!0):(a(),I(p,{key:0,"list-object":t.allPodcasts},{octopusSlide:q(({option:$})=>[y(r,{class:"flex-shrink-0 item-phone-margin",podcast:$},null,8,["podcast"])]),_:1},8,["list-object"]))]),_:1},8,["popular-sort","button-text","button-plus","title","href","iab-id","rubrique-id","no-rubriquage-id","onSortChrono","onSortPopular"])):s("",!0)}const et=P(Y,[["render",G]]);export{et as default};
