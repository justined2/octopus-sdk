import{d as E,Y as C,a2 as V,a4 as $,s as A,at as x,_ as P,r as m,o as u,e as v,w as S,f as T,t as f,B as I,c as R,i as y}from"./index.js";import M from"./ClassicLoading-Bf3Fy18F.js";import B from"./ClassicModal-mpJgF1dy.js";function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},g.apply(this,arguments)}var O=function(){var t=!1,r=[],a=function(){if(!t){t=!0;for(var n=0,d=r.length;n<d;n++)r[n]()}},i=function(n){if(!t){r.push(n);return}n()},c={resolved:function(){return t},resolve:a,promise:{then:i}};return c},k=Object.prototype.hasOwnProperty;function j(){var e=O();return{notify:function(){e.resolve()},wait:function(){return e.promise},render:function(r,a,i){this.wait().then(function(){i(window.grecaptcha.render(r,a))})},reset:function(r){typeof r>"u"||(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.reset(r)}))},execute:function(r){typeof r>"u"||(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.execute(r)}))},checkRecaptchaLoad:function(){k.call(window,"grecaptcha")&&k.call(window.grecaptcha,"render")&&this.notify()},assertLoaded:function(){if(!e.resolved())throw new Error("ReCAPTCHA has not been loaded")}}}var p=j();typeof window<"u"&&(window.vueRecaptchaApiLoaded=p.notify);var H=E({name:"VueRecaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String},badge:{type:String},type:{type:String},size:{type:String},tabindex:{type:String},loadRecaptchaScript:{type:Boolean,default:!0},recaptchaScriptId:{type:String,default:"__RECAPTCHA_SCRIPT"},recaptchaHost:{type:String,default:"www.google.com"},language:{type:String,default:""}},emits:["render","verify","expired","error"],setup:function(t,r){var a=r.slots,i=r.emit,c=C(null),s=C(null),n=function(h){i("verify",h)},d=function(){i("expired")},l=function(){i("error")};return V(function(){if(p.checkRecaptchaLoad(),t.loadRecaptchaScript&&!document.getElementById(t.recaptchaScriptId)){var o=document.createElement("script");o.id=t.recaptchaScriptId,o.src="https://"+t.recaptchaHost+"/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit&hl="+t.language,o.async=!0,o.defer=!0,document.head.appendChild(o)}var h=g({},t,{callback:n,"expired-callback":d,"error-callback":l}),w=c.value,L=a.default?w.children[0]:w;p.render(L,h,function(b){s.value=b,i("render",b)})}),{root:c,widgetId:s,reset:function(){p.reset(s.value)},execute:function(){p.execute(s.value)}}},render:function(){var t=this.$slots.default,r;return typeof t=="function"?r=t():r=t,$("div",{ref:"root"},r)}});const Y=E({name:"RecaptchaModal",components:{VueRecaptcha:H,ClassicModal:B,ClassicLoading:M},props:{idModal:{default:void 0,type:String},titleModal:{default:void 0,type:String},disableValidate:{default:!1,type:Boolean},errorText:{default:void 0,type:String},successText:{default:void 0,type:String}},emits:["close","validate"],data(){return{sendError:!1,isVerify:!1,isInTreatment:!1}},computed:{errorRecaptchaText(){return this.isCaptchaTest?this.$t("Recaptcha not active"):this.sendError?this.$t("Recaptcha error"):""},isCaptchaTest(){return A.generalParameters.isCaptchaTest}},methods:{async handleSuccess(e){this.isVerify=await x.checkToken(e),this.sendAction()},handleError(){this.isVerify=!1,this.sendError=!0},async submit(){if(this.isInTreatment=!0,!this.isVerify&&!this.isCaptchaTest)return this.$refs.invisibleRecaptcha.execute();this.sendAction()},closePopup(){this.$emit("close")},sendAction(){this.$emit("validate")}}}),z={class:"text-center text-danger"},D={key:2,class:"text-center h3"},N=["disabled"];function q(e,t,r,a,i,c){const s=m("ClassicLoading"),n=m("vue-recaptcha"),d=m("ClassicModal");return u(),v(d,{"id-modal":e.idModal,"title-modal":e.titleModal,closable:!1,onClose:e.closePopup},{body:S(()=>[T("div",z,f(e.errorRecaptchaText),1),e.isInTreatment?(u(),v(s,{key:1,"loading-text":e.isInTreatment&&!e.errorText&&!e.successText?e.$t("Loading content ..."):void 0,"error-text":e.errorText},null,8,["loading-text","error-text"])):I(e.$slots,"form",{key:0}),e.successText?(u(),R("div",D,f(e.successText),1)):y("",!0)]),footer:S(()=>[T("button",{class:"btn m-1",onClick:t[0]||(t[0]=(...l)=>e.closePopup&&e.closePopup(...l))},f(e.$t("Close")),1),e.isVerify?y("",!0):(u(),v(n,{key:0,ref:"invisibleRecaptcha","load-recaptcha-script":!0,size:"invisible",sitekey:"6LfyP_4ZAAAAAPODj8nov2LvosIwcX0GYeBSungh",onVerify:e.handleSuccess,onExpired:e.handleError},null,8,["onVerify","onExpired"])),!e.errorText&&!e.successText?(u(),R("button",{key:1,class:"btn btn-primary m-1",disabled:e.disableValidate||e.isInTreatment,onClick:t[1]||(t[1]=(...l)=>e.submit&&e.submit(...l))},f(e.$t("Yes")),9,N)):y("",!0)]),_:3},8,["id-modal","title-modal","onClose"])}const F=P(Y,[["render",q]]);export{F as R};
