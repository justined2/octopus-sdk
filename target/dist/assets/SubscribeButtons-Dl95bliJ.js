import{d as p,O as m,m as f,l as y,_ as b,r as w,o as n,c as o,f as r,F as u,b as c,z as a,y as g,A as W,e as L,g as _,w as C,h as U,t as k,T as v,i as z}from"./index.js";const E=p({name:"SubscribeButtons",components:{ClassicPopover:m},props:{emission:{default:void 0,type:Object},playlistId:{default:void 0,type:Number},windowWidth:{default:0,type:Number},justifyCenter:{default:!0,type:Boolean}},data(){return{hiddenLinks:[],lastWindowWidth:420}},computed:{...f(y,["apiUrl"]),subscriptionsDisplay(){return[{name:"applePodcast",icon:"saooti-apple-podcast",title:"Apple Podcast | iTunes",url:this.getUrl("applePodcast")},{name:"deezer",icon:"saooti-deezer",title:"Deezer",url:this.getUrl("deezer")},{name:"spotify",icon:"saooti-spotify",title:"Spotify",url:this.getUrl("spotify")},{name:"amazon",icon:"saooti-amazon-music",title:"Amazon Music",url:this.getUrl("amazon")},{name:"iHeart",icon:"saooti-iheart",title:"iHeart",url:this.getUrl("iHeart")},{name:"playerFm",icon:"saooti-playerfm",title:"PlayerFM",url:this.getUrl("playerFm")},{name:"pocketCasts",icon:"saooti-pocket-casts",title:"Pocket Casts",url:this.getUrl("pocketCasts")},{name:"podcastAddict",icon:"saooti-podcast-addict",title:"Podcast Addict",url:this.getUrl("podcastAddict")},{name:"radioline",icon:"saooti-radioline",title:"Radioline",url:this.getUrl("radioline")},{name:"tunein",icon:"saooti-tunin",title:"TuneIn",url:this.getUrl("tunein")},{name:"youtube",icon:"saooti-youtube",title:"YouTube Music",url:this.getUrl("youtube")}].filter(s=>s.url)},rssUrl(){let t=this.apiUrl+"rss/";if(this.emission)return t+"emission/"+this.emission?.emissionId+".rss";if(this.playlistId)return t+"playlist/"+this.playlistId+".rss"}},watch:{windowWidth(){this.resizeWindow()}},mounted(){this.resizeWindow()},methods:{getUrl(t){return this.externaliseLinks(this.emission?.annotations?.[t])},externaliseLinks(t){return t&&(t=t.trim(),!t.startsWith("http")&&!t.startsWith("//")?"//"+t:t)},showAllElements(){this.subscriptionsDisplay.forEach(t=>{const s=this.$refs["subLink"+t.name][0];s&&s.classList.contains("hid")&&s.classList.remove("hid")})},hideOnlyNecessaryElements(){let t=0;this.subscriptionsDisplay.forEach(s=>{const i=this.$refs["subLink"+s.name][0];if(i){if(!t){const l=i.clientWidth+20;t=(i.parentElement?.clientWidth??0)+(i.parentElement?.offsetLeft??0)-l}i.offsetLeft+i.clientWidth+20<t||(this.hiddenLinks.push(s),i.classList.contains("hid")||(i.className+=" hid"))}})},resizeWindow(){if(this.windowWidth>420&&this.lastWindowWidth>420){this.lastWindowWidth=this.windowWidth;return}const t=this.$refs.subscribeButtonsContainer;t===null||!t||t?.parentElement?.style.display==="none"||(this.lastWindowWidth=this.windowWidth,t.style.justifyContent="flex-start",t.style.flexGrow="1",this.hiddenLinks.length=0,this.showAllElements(),this.hideOnlyNecessaryElements(),!this.hiddenLinks.length&&this.justifyCenter&&(t.style.justifyContent="center"),t.style.flexGrow="0")}}}),A={key:0,class:"subscribe-buttons-container"},B={ref:"subscribeButtonsContainer"},D=["href","title"],N=["href","title"],P=["title"],$=["href"];function S(t,s,i,l,j,T){const h=w("ClassicPopover");return t.subscriptionsDisplay.length||t.rssUrl?(n(),o("div",A,[r("div",B,[(n(!0),o(u,null,c(t.subscriptionsDisplay,(e,d)=>(n(),o("a",{key:e.name,ref_for:!0,ref:"subLink"+e.name,rel:"noopener",target:"_blank",class:a([[d===0?"first":"",t.subscriptionsDisplay.length-1===d?"last":""],"btn share-btn mx-2"]),href:e.url,title:e.title},[r("span",{class:a(e.icon)},null,2)],10,D))),128))],512),r("a",{rel:"noopener",target:"_blank",class:"btn share-btn mx-2 saooti-rss",href:t.rssUrl,title:t.$t("Rss feed")},null,8,N),g(r("button",{id:"subscribe-buttons-dropdown",class:"btn share-btn mx-2 saooti-more",title:t.$t("See more")},null,8,P),[[W,t.hiddenLinks.length]]),(n(),L(v,{to:".octopus-app"},[_(h,{target:"subscribe-buttons-dropdown","popover-class":"popover-z-index","only-click":!0,"is-fixed":!0,"left-pos":!0},{default:C(()=>[(n(!0),o(u,null,c(t.hiddenLinks,e=>(n(),o("a",{key:e.name,rel:"noopener",target:"_blank",class:"octopus-dropdown-item justify-content-start",href:e.url,realLink:"true"},[r("span",{class:a([e.icon,"me-1"])},null,2),U(" "+k(e.title),1)],8,$))),128))]),_:1})]))])):z("",!0)}const F=b(E,[["render",S]]);export{F as default};
