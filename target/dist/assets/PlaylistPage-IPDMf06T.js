const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ShareButtons-9SDHM0bh.js","assets/index.js","assets/index.css","assets/displayMethods-CzaGbBDz.js","assets/ShareButtons--uAtP8TI.css","assets/EditBox-Et76Rrff.js","assets/SharePlayer-BmPnWwe5.js","assets/SharePlayer-qTl7ZWgg.css","assets/PodcastmakerHeader-CO1f5Iwt.js","assets/PodcastmakerHeader-BgINiLsA.css"])))=>i.map(i=>d[i]);
import{d as v,C as R,j as b,p as L,_ as E,r as i,o as a,c as d,f as o,t as f,e as r,i as l,g as p,w as n,F as $,b as B,h as M,k as S,m as T,D as A,s as z,n as U,u as N,q as h,v as c,x as O,y as V,z as Q}from"./index.js";import{o as C}from"./orgaComputed-ovvKvHgW.js";import H from"./ClassicLoading-Bf3Fy18F.js";import{L as j}from"./ListPaginate-edBLm_Ig.js";import{P as q}from"./PodcastItem-BYhh4qWG.js";import{C as F}from"./ClassicSearch-DeffNtC6.js";import{d as G}from"./displayMethods-CzaGbBDz.js";import"./ClassicSpinner-CcbqjM9h.js";import"./dom-BVfCmWpy.js";import"./PodcastImage-jptmSDc7.js";import"./PodcastPlayButton-DEKHY6Ml.js";const J=v({name:"PodcastList",components:{PodcastItem:q,ClassicSearch:F,ListPaginate:j,ClassicLazy:R},mixins:[b,C],props:{playlist:{default:()=>({}),type:Object}},data(){return{loading:!0,podcasts:[],podcastsQuery:[],size:30,first:0,searchPattern:"",isMobile:!1}},computed:{titleList(){return this.notEmptyPlaylist?this.$t("Podcasts in the playlist"):this.$t("No podcasts in the playlist")},notEmptyPlaylist(){return Object.keys(this.playlist.samplingViews??[]).length!==0},podcastsDisplay(){return this.isMobile?this.podcastsQuery.slice(0,Math.min(this.first+this.size,this.podcasts.length)):this.podcastsQuery.slice(this.first,Math.min(this.first+this.size,this.podcasts.length))},editRight(){return this.isEditRights(this.playlist.organisation?.id)}},watch:{searchPattern(){this.searchPattern!==""?this.podcastsQuery=this.podcasts.filter(t=>t.title.toLowerCase().includes(this.searchPattern.toLowerCase())):this.podcastsQuery=this.podcasts}},created(){this.fetchContent()},methods:{async fetchContent(){if(this.notEmptyPlaylist){this.podcasts.length=0,this.loading=!0;try{this.podcasts=await L.fetchData({api:0,path:"playlist/"+this.playlist.playlistId+"/content"}),this.editRight||(this.podcasts=this.podcasts.filter(t=>t!==null&&(!t.availability||t.availability.visibility===!0))),this.podcastsQuery=this.podcasts}catch(t){this.handle403(t)}}this.loading=!1}}}),K={class:"mt-3 align-self-baseline"},W={class:"podcast-list"};function X(t,e,I,k,_,w){const y=i("ClassicSearch"),m=i("PodcastItem"),u=i("router-link"),g=i("ClassicLazy"),P=i("ListPaginate");return a(),d("div",null,[o("h2",K,f(t.titleList),1),!t.loading&&t.notEmptyPlaylist?(a(),r(y,{key:0,textInit:t.searchPattern,"onUpdate:textInit":e[0]||(e[0]=s=>t.searchPattern=s),class:"width-600 align-self-baseline mb-2","id-search":"podcast-list-search",label:t.$t("Search")},null,8,["textInit","label"])):l("",!0),p(P,{id:"podcastPlaylistListPaginate",first:t.first,"onUpdate:first":e[1]||(e[1]=s=>t.first=s),rowsPerPage:t.size,"onUpdate:rowsPerPage":e[2]||(e[2]=s=>t.size=s),isMobile:t.isMobile,"onUpdate:isMobile":e[3]||(e[3]=s=>t.isMobile=s),"text-count":t.podcasts.length>1?`${t.$t("Number podcasts",{nb:t.podcasts.length})}`:void 0,"total-count":t.podcasts.length,loading:t.loading,"loading-text":t.loading?t.$t("Loading podcasts ..."):void 0,"error-text":!t.loading&&!t.podcasts.length&&t.notEmptyPlaylist?t.$t("No podcast match your query"):void 0,"player-responsive":!0},{list:n(()=>[o("div",W,[(a(!0),d($,null,B(t.podcastsDisplay,s=>(a(),r(g,{key:s.podcastId,"min-height":410},{preview:n(()=>[p(u,{to:{name:"podcast",params:{podcastId:s.podcastId}}},{default:n(()=>[M(f(s.title),1)]),_:2},1032,["to"])]),default:n(()=>[s.podcastId!==0?(a(),r(m,{key:0,podcast:s},null,8,["podcast"])):l("",!0)]),_:2},1024))),128))])]),_:1},8,["first","rowsPerPage","isMobile","text-count","total-count","loading","loading-text","error-text"])])}const Y=E(J,[["render",X]]),Z=h(()=>c(()=>import("./ShareButtons-9SDHM0bh.js"),__vite__mapDeps([0,1,2,3,4]))),x=h(()=>c(()=>import("./EditBox-Et76Rrff.js"),__vite__mapDeps([5,1,2]))),tt=h(()=>c(()=>import("./SharePlayer-BmPnWwe5.js"),__vite__mapDeps([6,1,2,7]))),st=h(()=>c(()=>import("./PodcastmakerHeader-CO1f5Iwt.js"),__vite__mapDeps([8,1,2,9]))),it=v({components:{ShareButtons:Z,EditBox:x,PodcastList:Y,SharePlayer:tt,ClassicLoading:H,PodcastmakerHeader:st},mixins:[G,b,C,S],props:{playlistId:{default:void 0,type:Number},isEducation:{default:!1,type:Boolean}},emits:["playlistTitle"],data(){return{loaded:!1,playlist:void 0,error:!1}},computed:{...T(A,["isRolePlaylists"]),pageParameters(){return{isShareButtons:z.podcastPage.ShareButtons}},pageTitle(){return this.playlistRadio?this.$t("Mix of episodes"):this.$t("Playlist")},playlistRadio(){return this.playlist?.ambianceType==="AMBIANCE"||this.playlist?.ambianceType==="AMBIANCE_PROGRAMMED"},name(){return this.playlist?.title??""},description(){return this.playlist?.description??""},editRight(){return this.isEditRights(this.playlist?.organisation?.id,this.isRolePlaylists)}},watch:{playlistId:{immediate:!0,handler(){this.getPlaylistDetails()}}},beforeUnmount(){this.contentToDisplayUpdate(null)},methods:{...U(N,["contentToDisplayUpdate"]),initError(){this.error=!0,this.loaded=!0},async getPlaylistDetails(){try{if(this.loaded=!1,this.error=!1,this.playlist=await L.fetchData({api:0,path:"playlist/"+this.playlistId}),!this.editRight&&this.playlistRadio||this.playlist.organisation?.privacy!=="PUBLIC"&&this.filterOrgaId!==this.playlist.organisation?.id&&this.$route.query.productor!==this.playlist.organisation?.id){this.initError();return}this.contentToDisplayUpdate(this.playlist),this.$emit("playlistTitle",this.playlist.title)}catch(t){this.handle403(t),this.initError()}this.loaded=!0}}}),at={class:"page-box"},et={class:"module-box"},ot={class:"mb-5 mt-3 descriptionText"},lt=["alt"],rt=["innerHTML"];function nt(t,e,I,k,_,w){const y=i("PodcastmakerHeader"),m=i("EditBox"),u=i("SharePlayer"),g=i("ShareButtons"),P=i("PodcastList"),s=i("ClassicLoading"),D=O("lazy");return a(),d("div",at,[t.loaded&&!t.error?(a(),d($,{key:0},[t.isPodcastmaker?(a(),r(y,{key:0,"page-title":t.pageTitle,"image-url":t.playlist.imageUrl},null,8,["page-title","image-url"])):l("",!0),o("div",{class:Q(["d-flex flex-column page-element",t.isPodcastmaker?"page-element-podcastmaker":""])},[o("div",et,[o("div",ot,[V(o("img",{width:"250",height:"250",alt:t.$t("Playlist name image",{name:t.name}),class:"img-box float-start me-3 mb-3"},null,8,lt),[[D,t.proxyImageUrl(t.playlist.imageUrl,"250")]]),o("h2",null,f(t.name),1),o("p",{class:"html-wysiwyg-content",innerHTML:t.urlify(t.description)},null,8,rt)]),t.editRight&&!t.isPodcastmaker?(a(),r(m,{key:0,playlist:t.playlist},null,8,["playlist"])):l("",!0)]),!t.isPodcastmaker&&t.authOrgaId!==void 0?(a(),r(u,{key:0,playlist:t.playlist,"organisation-id":t.authOrgaId,"is-education":t.isEducation},null,8,["playlist","organisation-id","is-education"])):l("",!0),t.pageParameters.isShareButtons?(a(),r(g,{key:1,playlist:t.playlist,"organisation-id":t.playlist.organisation.id},null,8,["playlist","organisation-id"])):l("",!0),p(P,{playlist:t.playlist},null,8,["playlist"])],2)],64)):l("",!0),p(s,{"loading-text":t.loaded?void 0:t.$t("Loading content ..."),"error-text":t.error?t.$t("Playlist doesn't exist"):void 0},null,8,["loading-text","error-text"])])}const bt=E(it,[["render",nt]]);export{bt as default};
