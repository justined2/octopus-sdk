const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CommentList-BWhdSQK7.js","assets/index.js","assets/index.css","assets/ClassicLoading-Bf3Fy18F.js","assets/ClassicSpinner-CcbqjM9h.js","assets/ClassicSpinner-DKas6cj3.css","assets/CommentList-QF_PSRV9.css","assets/CommentInput-WkxXdM41.js","assets/config-CKXj5qII.js","assets/CommentStore-DzAJcgPT.js","assets/CommentInput-DrWGTqSw.css"])))=>i.map(i=>d[i]);
import{d as p,L as C,m as s,D as h,n as v,q as d,v as c,_ as f,r as i,y as u,A as g,o as a,c as P,f as o,t as I,e as _,i as b,g as E}from"./index.js";import{u as m}from"./CommentStore-DzAJcgPT.js";const T=d(()=>c(()=>import("./CommentList-BWhdSQK7.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),w=d(()=>c(()=>import("./CommentInput-WkxXdM41.js"),__vite__mapDeps([7,1,2,8,9,10]))),y=p({name:"CommentSection",components:{CommentList:T,CommentInput:w},mixins:[C],props:{podcast:{default:void 0,type:Object}},data(){return{reload:!1,configPodcast:void 0,nbComments:0,eventToHandle:void 0}},computed:{...s(m,["commentEventToHandle","commentInitialized","commentPodcastId"]),...s(h,["authOrgaId"]),displayCommentSection(){return this.canPostComment||this.nbComments>0},canPostComment(){return this.getCanPostComment(this.configPodcast,this.podcast,this.authOrgaId!==void 0)},eventActive(){return this.podcast?.conferenceId!==void 0}},watch:{commentEventToHandle:{deep:!0,handler(){!this.commentEventToHandle.length||this.commentPodcastId!==this.podcast?.podcastId||(this.eventToHandle=this.commentEventToHandle[0],this.commentEventHandled())}}},created(){this.fetchPodcastCommentsConfig()},methods:{...v(m,["getCommentsConfig","getCanPostComment","commentEventHandled","initialize","initComments"]),async fetchPodcastCommentsConfig(){this.podcast?.podcastId&&(this.configPodcast=await this.getCommentsConfig(this.podcast),this.eventActive&&this.initLiveComments())},async initLiveComments(){!this.podcast?.podcastId||!this.podcast?.organisation.id||(this.commentInitialized||await this.initialize(),await this.initComments(this.podcast.podcastId,this.podcast.organisation.id))},newComment(t){this.eventActive||(this.eventToHandle={type:"CREATE",comment:t})}}}),A={class:"module-box"},H={class:"d-flex align-items-center"},S={class:"mb-0 me-2"},L=["title"];function $(t,e,k,D,N,O){const r=i("CommentInput"),l=i("CommentList");return u((a(),P("div",A,[o("div",H,[o("h2",S,I(t.$t("Podcast's comments")),1),o("button",{title:t.$t("Refresh"),class:"btn btn-transparent saooti-refresh",onClick:e[0]||(e[0]=n=>t.reload=!t.reload)},null,8,L)]),t.canPostComment?(a(),_(r,{key:0,podcast:t.podcast,onNewComment:t.newComment},null,8,["podcast","onNewComment"])):b("",!0),E(l,{nbComments:t.nbComments,"onUpdate:nbComments":e[1]||(e[1]=n=>t.nbComments=n),class:"mt-5",podcast:t.podcast,reload:t.reload,config:t.configPodcast,"event-to-handle":t.eventToHandle},null,8,["nbComments","podcast","reload","config","event-to-handle"])],512)),[[g,t.displayCommentSection]])}const B=f(y,[["render",$]]);export{B as default};
