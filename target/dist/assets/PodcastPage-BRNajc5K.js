const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ErrorMessage-B9AVO0t8.js","assets/index.js","assets/index.css","assets/ErrorMessage-wiOoHUCf.css","assets/RecordingItemButton-C76tCGkl.js","assets/EditBox-Et76Rrff.js","assets/PodcastPlayBar-lf7uxuMu.js","assets/ProgressBar-Du9DcDQS.js","assets/ProgressBar-c6qSncaO.css","assets/displayMethods-CzaGbBDz.js","assets/SubscribeButtons-Dl95bliJ.js","assets/SubscribeButtons-Cn_L18lM.css","assets/LikeSection-DK14EKxf.js","assets/CommentStore-DzAJcgPT.js","assets/CountDown-CeKXXiBW.js","assets/countdown-Cu28gV8a.js","assets/TagList-Cyrt_pP7.js","assets/TagList-DNGEvtAX.css","assets/ShareButtons-9SDHM0bh.js","assets/ShareButtons--uAtP8TI.css","assets/SharePlayer-BmPnWwe5.js","assets/SharePlayer-qTl7ZWgg.css","assets/CommentSection-vHP3z2bv.js","assets/PodcastmakerHeader-CO1f5Iwt.js","assets/PodcastmakerHeader-BgINiLsA.css"])))=>i.map(i=>d[i]);
import{d as O,E as H,m as k,D as A,s as L,q as r,v as c,_ as B,r as o,o as e,c as i,f as p,g as n,z as _,t as a,i as s,e as d,h as v,w as y,C as z,j as F,k as q,u as D,n as $,p as b,F as S,b as Y}from"./index.js";import{o as T}from"./orgaComputed-ovvKvHgW.js";import{P as K}from"./PodcastInlineList-jdw8YJzC.js";import{P as W}from"./PodcastImage-jptmSDc7.js";import J from"./ParticipantDescription-D-Y0QD9P.js";import{P as Q}from"./PodcastRawTranscript-DgP4GALl.js";import{d as X}from"./displayMethods-CzaGbBDz.js";import{p as Z}from"./podcastView-CNJ9XSY0.js";import x from"./ClassicLoading-Bf3Fy18F.js";import{u as tt}from"./CommentStore-DzAJcgPT.js";import"./PodcastPlayButton-DEKHY6Ml.js";import"./ClassicSpinner-CcbqjM9h.js";const et=r(()=>c(()=>import("./ErrorMessage-B9AVO0t8.js"),__vite__mapDeps([0,1,2,3]))),st=r(()=>c(()=>import("./RecordingItemButton-C76tCGkl.js"),__vite__mapDeps([4,1,2]))),ot=r(()=>c(()=>import("./EditBox-Et76Rrff.js"),__vite__mapDeps([5,1,2]))),it=r(()=>c(()=>import("./PodcastPlayBar-lf7uxuMu.js"),__vite__mapDeps([6,7,1,2,8,9]))),at=r(()=>c(()=>import("./SubscribeButtons-Dl95bliJ.js"),__vite__mapDeps([10,1,2,11]))),nt=r(()=>c(()=>import("./LikeSection-DK14EKxf.js"),__vite__mapDeps([12,1,2,13]))),dt=r(()=>c(()=>import("./CountDown-CeKXXiBW.js"),__vite__mapDeps([14,15,1,2]))),rt=r(()=>c(()=>import("./TagList-Cyrt_pP7.js"),__vite__mapDeps([16,1,2,17]))),ct=O({name:"PodcastModuleBox",components:{PodcastImage:W,ParticipantDescription:J,TagList:rt,ErrorMessage:et,PodcastPlayBar:it,EditBox:ot,RecordingItemButton:st,SubscribeButtons:at,Countdown:dt,LikeSection:nt,PodcastRawTranscript:Q},mixins:[X,T,H,Z],props:{playingPodcast:{default:void 0,type:Object},podcast:{default:void 0,type:Object},podcastConference:{default:void 0,type:Object}},emits:["updatePodcast"],data(){return{isPhone:!1,windowWidth:0}},computed:{...k(A,["isRoleLive"]),errorMessage(){return this.podcast?.availability.visibility?this.podcast?.processingStatus==="ERROR"?this.$t("Podcast in ERROR, please contact Saooti"):this.podcastNotValid?this.$t("Podcast not validated"):"":this.$t("Podcast is not visible for listeners")},isProgressBar(){return L.emissionsPage.progressBar},editRight(){return this.isEditRights(this.podcast?.organisation.id)},isLiveReady(){return this.podcast?.conferenceId!==void 0&&this.podcast?.conferenceId!==0&&this.podcast?.processingStatus==="READY"},isDebriefing(){return this.podcastConference!==void 0&&this.podcastConference.status==="DEBRIEFING"},isOctopusAndAnimator(){return!this.isPodcastmaker&&this.editRight&&this.isRoleLive},podcastNotValid(){return this.podcast?.availability!==void 0&&this.podcast?.valid===!1},photoCredit(){return this.podcast?.annotations?.photoCredit??""},audioCredit(){return this.podcast?.annotations?.audioCredit??""},authorCredit(){return this.podcast?.annotations?.authorCredit??""},isEditBox(){return!(L.generalParameters.podcastmaker??!1)}},methods:{removeDeleted(){this.isLiveReadyToRecord?this.$router.push("/main/pub/lives"):window.history.length>1?this.$router.go(-1):this.$router.push("/")}}}),pt={key:0,class:"module-box"},lt={class:"mb-2 d-flex"},ut={class:"w-100"},mt={class:"d-flex justify-content-between flex-wrap mb-2"},ht={key:1,class:"text-danger"},ft={class:"h2 mb-3"},gt=["innerHTML"],vt={class:"my-3"},yt={class:"mb-1"},Pt={key:0,class:"mb-1"},Ct={key:1,class:"mb-1"},It={key:2,class:"mb-1"},Rt={key:3,class:"mb-1"},Et=["href"],bt={key:6},St={key:0,class:"me-5 text-secondary"};function kt(t,l,w,V,M,N){const P=o("PodcastImage"),C=o("Countdown"),h=o("router-link"),f=o("ParticipantDescription"),m=o("PodcastPlayBar"),I=o("ErrorMessage"),g=o("LikeSection"),R=o("TagList"),u=o("PodcastRawTranscript"),U=o("SubscribeButtons"),j=o("RecordingItemButton"),G=o("EditBox");return t.podcast?(e(),i("div",pt,[p("div",lt,[p("div",ut,[n(P,{class:_([[t.isLiveReadyToRecord&&t.podcastConference&&t.podcastConference!=="null"&&t.podcastConference.status?t.podcastConference.status.toLowerCase()+"-shadow":""],"me-3"]),"hide-play":t.isLiveReadyToRecord,podcast:t.podcast,"playing-podcast":t.playingPodcast,"fetch-conference":t.podcastConference,"is-animator-live":t.isOctopusAndAnimator},null,8,["class","hide-play","podcast","playing-podcast","fetch-conference","is-animator-live"]),p("div",mt,[t.date.length!==0?(e(),i("div",{key:0,class:_(t.isLiveReady?"":"me-5")},a(t.date),3)):s("",!0),p("div",null,a(t.duration),1),t.isLiveReady?(e(),i("div",ht,a(t.$t("Episode record in live")),1)):s("",!0)]),p("div",ft,a(t.podcast.title),1),t.isCounter?(e(),d(C,{key:0,"time-remaining":t.timeRemaining},null,8,["time-remaining"])):s("",!0),p("div",{class:"descriptionText html-wysiwyg-content",innerHTML:t.urlify(t.podcast.description)},null,8,gt),p("div",vt,[p("div",yt,[v(a(t.$t("Emission")+" : ")+" ",1),n(h,{to:{name:"emission",params:{emissionId:t.podcast.emission.emissionId},query:{productor:t.filterOrgaId}}},{default:y(()=>[v(a(t.podcast.emission.name),1)]),_:1},8,["to"])]),n(f,{class:"mb-1",participants:t.podcast.animators},null,8,["participants"]),n(f,{class:"mb-1",participants:t.podcast.guests,"is-guest":!0},null,8,["participants"]),t.isPodcastmaker?s("",!0):(e(),i("div",Pt,[v(a(t.$t("Producted by : "))+" ",1),n(h,{to:{name:"productor",params:{productorId:t.podcast.organisation.id},query:{productor:t.filterOrgaId}}},{default:y(()=>[v(a(t.podcast.organisation.name),1)]),_:1},8,["to"])])),t.photoCredit!==""?(e(),i("div",Ct,a(t.$t("Photo credits")+" : "+t.photoCredit),1)):s("",!0),t.audioCredit!==""?(e(),i("div",It,a(t.$t("Audio credits")+" : "+t.audioCredit),1)):s("",!0),t.authorCredit!==""?(e(),i("div",Rt,a(t.$t("Author credits")+" : "+t.authorCredit),1)):s("",!0),t.podcast.article?(e(),i("a",{key:4,class:"btn d-flex align-items-center my-2 width-fit-content mb-1",href:t.podcast.article,rel:"noopener",target:"_blank"},[l[2]||(l[2]=p("span",{class:"saooti-newspaper me-1"},null,-1)),p("div",null,a(t.$t("See associated article")),1)],8,Et)):s("",!0),t.isProgressBar?(e(),d(m,{key:5,"podcast-id":t.podcast.podcastId,duration:t.podcast.duration},null,8,["podcast-id","duration"])):s("",!0),t.editRight&&!t.isPodcastmaker?(e(),i("div",bt,[t.podcast.annotations&&t.podcast.annotations.SOURCE_KIND==="RSS"?(e(),i("div",St,a(t.$t("From RSS")),1)):s("",!0),t.errorMessage!==""?(e(),d(I,{key:1,message:t.errorMessage},null,8,["message"])):s("",!0)])):s("",!0),n(g,{"edit-right":t.editRight,podcast:t.podcast},null,8,["edit-right","podcast"])])])]),t.podcast.tags!==void 0&&t.podcast.tags.length!==0&&!t.isPhone?(e(),d(R,{key:0,"tag-list":t.podcast.tags,"podcast-annotations":t.podcast.annotations},null,8,["tag-list","podcast-annotations"])):s("",!0),n(u,{"podcast-id":t.podcast.podcastId},null,8,["podcast-id"]),t.isPodcastmaker?(e(),d(U,{key:1,class:"mt-4",emission:t.podcast.emission,"window-width":1e3,"justify-center":!1},null,8,["emission"])):s("",!0),t.podcastConference&&t.isLiveReadyToRecord&&t.isOctopusAndAnimator?(e(),d(j,{key:2,podcast:t.podcast,live:!0,recording:t.podcastConference,onDeleteItem:t.removeDeleted,onValidatePodcast:l[0]||(l[0]=E=>t.$emit("updatePodcast",E))},null,8,["podcast","recording","onDeleteItem"])):t.editRight&&t.isEditBox?(e(),d(G,{key:3,podcast:t.podcast,"display-studio-access":t.isDebriefing,onValidatePodcast:l[1]||(l[1]=E=>t.$emit("updatePodcast",E))},null,8,["podcast","display-studio-access"])):s("",!0)])):s("",!0)}const Lt=B(ct,[["render",kt]]),_t=r(()=>c(()=>import("./ShareButtons-9SDHM0bh.js"),__vite__mapDeps([18,1,2,9,19]))),Dt=r(()=>c(()=>import("./SharePlayer-BmPnWwe5.js"),__vite__mapDeps([20,1,2,21]))),$t=r(()=>c(()=>import("./CommentSection-vHP3z2bv.js"),__vite__mapDeps([22,1,2,13]))),Ot=r(()=>c(()=>import("./PodcastmakerHeader-CO1f5Iwt.js"),__vite__mapDeps([23,1,2,24]))),At=O({name:"PodcastPage",components:{PodcastInlineList:K,ShareButtons:_t,SharePlayer:Dt,CommentSection:$t,PodcastModuleBox:Lt,ClassicLoading:x,ClassicLazy:z,PodcastmakerHeader:Ot},mixins:[F,T,q],props:{updateStatus:{default:void 0,type:String},playingPodcast:{default:void 0,type:Object},podcastId:{default:0,type:Number},isEducation:{default:!1,type:Boolean}},emits:["initConferenceId","podcastInfo"],data(){return{loaded:!1,podcast:void 0,error:!1,exclusive:!1,notExclusive:!1,fetchConference:void 0}},computed:{...k(A,["isRoleLive"]),...k(D,["storedCategories"]),hideSuggestions(){return this.podcast?.emission?.annotations?.HIDE_SUGGESTIONS==="true"},pageParameters(){return{isShareButtons:L.podcastPage.ShareButtons}},emissionMainCategory(){return this.podcast?this.podcast.emission.annotations?.mainIabId?parseInt(this.podcast.emission.annotations.mainIabId,10):this.podcast.emission.iabIds?.length?this.podcast.emission.iabIds[0]:0:0},categories(){return typeof this.podcast>"u"?[]:this.storedCategories.filter(t=>this.podcast?.emission.iabIds&&this.podcast.emission.iabIds.indexOf(t.id)!==-1).sort((t,l)=>t.id===this.emissionMainCategory?-1:l.id===this.emissionMainCategory?1:0)},editRight(){return this.isEditRights(this.podcast?.organisation.id)},isLiveReadyToRecord(){return this.podcast?.conferenceId!==void 0&&this.podcast?.conferenceId!==0&&this.podcast?.processingStatus==="READY_TO_RECORD"},isOctopusAndAnimator(){return!this.isPodcastmaker&&this.editRight&&this.isRoleLive},titlePage(){return this.isLiveReadyToRecord?this.$t("Live episode"):this.$t("Episode")}},watch:{updateStatus(){this.fetchConference&&this.fetchConference!==null&&(this.fetchConference.status=this.updateStatus)},podcastId:{immediate:!0,async handler(){await this.getPodcastDetails(),!(!this.podcast||this.error)&&(this.getCommentsConfig(this.podcast),this.initCommentUser(),this.initConference())}}},beforeUnmount(){this.contentToDisplayUpdate(null)},methods:{...$(D,["contentToDisplayUpdate"]),...$(tt,["getCommentsConfig","initCommentUser"]),async fetchConferencePublic(){const t=await b.fetchData({api:9,path:"conference/info/"+this.podcast?.conferenceId});this.fetchConference={...t,conferenceId:this.podcast?.conferenceId??0,title:""}},async initConference(){if(!(!this.podcast||this.podcast.conferenceId==null)){if(this.isOctopusAndAnimator)try{const t=await b.fetchData({api:9,path:"conference/"+this.podcast.conferenceId});this.fetchConference=t??{conferenceId:-1,title:""}}catch{await this.fetchConferencePublic()}else await this.fetchConferencePublic();this.fetchConference&&this.fetchConference.conferenceId!==-1&&this.fetchConference.status!=="PUBLISHING"&&this.fetchConference.status!=="DEBRIEFING"&&this.$emit("initConferenceId",this.podcast.conferenceId)}},updatePodcast(t){this.podcast=t},initError(){this.error=!0,this.loaded=!0},handleAnnotations(){this.podcast&&(this.podcast.emission.annotations?.exclusive&&(this.exclusive=this.podcast.emission.annotations.exclusive==="true",this.exclusive=this.exclusive&&this.authOrgaId!==this.podcast.organisation.id),this.podcast.emission.annotations?.notExclusive&&(this.notExclusive=this.podcast.emission.annotations.notExclusive==="true"))},async getPodcastDetails(){this.loaded=!1,this.error=!1;try{const t=await b.fetchData({api:0,path:"podcast/"+this.podcastId});if(t.organisation.privacy!=="PUBLIC"&&this.filterOrgaId!==t.organisation.id&&this.$route.query.productor!==t.organisation.id){this.initError();return}this.podcast=t,this.contentToDisplayUpdate(t),this.$emit("podcastInfo",{title:this.podcast.title}),this.handleAnnotations(),(!this.podcast.availability.visibility||this.podcast.processingStatus!=="READY_TO_RECORD"&&this.podcast.processingStatus!=="READY"&&this.podcast.processingStatus!=="PROCESSING"||this.podcast.valid===!1)&&!this.editRight&&(this.error=!0),this.loaded=!0}catch(t){this.handle403(t),this.initError()}}}}),Bt={class:"page-box"};function Tt(t,l,w,V,M,N){const P=o("PodcastmakerHeader"),C=o("PodcastModuleBox"),h=o("SharePlayer"),f=o("CommentSection"),m=o("PodcastInlineList"),I=o("ShareButtons"),g=o("ClassicLazy"),R=o("ClassicLoading");return e(),i("div",Bt,[t.loaded&&!t.error?(e(),i(S,{key:0},[t.isPodcastmaker?(e(),d(P,{key:0,"page-title":t.titlePage,"image-url":t.podcast.imageUrl},null,8,["page-title","image-url"])):s("",!0),p("div",{class:_(["d-flex flex-column page-element",t.isPodcastmaker?"page-element-podcastmaker":""])},[n(C,{"playing-podcast":t.playingPodcast,podcast:t.podcast,"podcast-conference":t.fetchConference,onUpdatePodcast:t.updatePodcast},null,8,["playing-podcast","podcast","podcast-conference","onUpdatePodcast"]),!t.isPodcastmaker&&(t.authOrgaId!==void 0||t.notExclusive)?(e(),d(h,{key:0,podcast:t.podcast,emission:t.podcast.emission,exclusive:t.exclusive,"not-exclusive":t.notExclusive,"organisation-id":t.authOrgaId,"is-education":t.isEducation},null,8,["podcast","emission","exclusive","not-exclusive","organisation-id","is-education"])):s("",!0),t.isPodcastmaker?s("",!0):(e(),d(f,{key:1,podcast:t.podcast},null,8,["podcast"])),n(m,{class:"module-box","emission-id":t.podcast.emission.emissionId,href:"/main/pub/emission/"+t.podcast.emission.emissionId,title:t.$t("More episodes of this emission"),"button-text":t.$t("All podcast emission button")},null,8,["emission-id","href","title","button-text"]),t.pageParameters.isShareButtons?(e(),d(I,{key:2,podcast:t.podcast,"organisation-id":t.podcast.organisation.id},null,8,["podcast","organisation-id"])):s("",!0),t.hideSuggestions?s("",!0):(e(),i(S,{key:3},[n(g,{"min-height":550},{default:y(()=>[n(m,{class:"mt-4","podcast-id":t.podcastId,title:t.$t("Suggested listening")},null,8,["podcast-id","title"])]),_:1}),(e(!0),i(S,null,Y(t.categories,u=>(e(),d(g,{key:u.id,"min-height":550},{default:y(()=>[n(m,{class:"mt-4","iab-id":u.id,href:"/main/pub/category/"+u.id,title:t.$t("More episodes of this category : ",{name:u.name}),"button-text":t.$t("All podcast button",{name:u.name})},null,8,["iab-id","href","title","button-text"])]),_:2},1024))),128))],64))],2)],64)):s("",!0),n(R,{"loading-text":t.loaded?void 0:t.$t("Loading content ..."),"error-text":t.error?t.$t("This episode is not available for (re)listening"):void 0},null,8,["loading-text","error-text"])])}const Kt=B(At,[["render",Tt]]);export{Kt as default};
