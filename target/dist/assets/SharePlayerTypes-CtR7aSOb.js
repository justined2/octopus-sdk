import{d as h,m as p,D as y,p as u,_ as v,o as a,c as o,f as d,F as n,b as c,t as m,i as f}from"./index.js";const P=h({props:{podcast:{default:void 0,type:Object},emission:{default:void 0,type:Object},playlist:{default:void 0,type:Object},iFrameModel:{default:"default",type:String},typeCustomPlayer:{default:"",type:String},organisationId:{default:void 0,type:String},isLive:{default:!1,type:Boolean}},emits:["update:iFrameModel","update:typeCustomPlayer"],data(){return{customPlayers:[]}},computed:{...p(y,["authOrgaId"]),isVideoPodcast(){return this.podcast!==void 0&&this.podcast.video?.videoId!==void 0},optionsSelectLive(){return[{name:this.$t("Large version"),value:"large",condition:!0},{name:this.$t("High version"),value:"videoLive",condition:this.podcast?.podcastId}]},optionsSelect(){return this.isLive?this.optionsSelectLive:[{name:this.$t("Video Version"),value:"video",condition:this.isVideoPodcast},{name:this.$t("Default version"),value:"default",condition:!0},{name:this.$t("Large version"),value:"large",condition:!0},{name:this.$t("Full Large version"),value:"largeMore",condition:this.podcast?.podcastId},{name:this.$t("Emission version"),value:"emission",condition:this.podcast?.podcastId},{name:this.$t("Large emission version"),value:"emissionLarge",condition:this.podcast?.podcastId},{name:this.$t("Large suggestion version"),value:"largeSuggestion",condition:this.podcast?.podcastId}]},customPlayersDisplay(){return this.customPlayers.filter(t=>(t.typePlayer==="EPISODE"||t.typePlayer==="SUGGESTION")&&this.podcast?.podcastId||t.typePlayer==="EMISSION"&&this.emission&&!this.podcast||t.typePlayer==="PLAYLIST"&&this.playlist)}},created(){this.isVideoPodcast&&this.$emit("update:iFrameModel","video"),!this.isLive&&this.initCustomPlayers()},methods:{isNumeric(t){return/^-?\d+$/.test(t)},selectChange(t){const e=t.target.value;if(e)if(this.isNumeric(e)){const s=this.customPlayersDisplay.find(r=>r.customId.toString()===e);s&&this.selectCustomPlayer(s)}else this.$emit("update:iFrameModel",e)},async fetchPlayerPaginate(t){let e=await u.fetchData({api:6,path:"customPlayer/type/"+this.organisationId+"/"+t,isNotAuth:!0}),s=e.content;const r=e.totalElements;let l=1;for(;r>s.length;)e=await u.fetchData({api:6,path:"customPlayer/type/"+this.organisationId+"/"+t+"?start="+l,isNotAuth:!0}),s=s.concat(e.content),++l;return s},selectCustomPlayer(t){this.$emit("update:typeCustomPlayer",t.typePlayer),this.$emit("update:iFrameModel",t.customId.toString())},async fetchCustomPlayers(t,e=!0){let s=await this.fetchPlayerPaginate(t);return this.customPlayers=this.customPlayers.concat(s),this.iFrameModel!=="video"&&e&&s?.[0]?.selected?(this.selectCustomPlayer(this.customPlayers[0]),!0):!1},async initCustomPlayers(){if(this.authOrgaId!==void 0)if(this.playlist)this.fetchCustomPlayers("PLAYLIST");else if(this.emission&&!this.podcast)this.fetchCustomPlayers("EMISSION");else{const t=await this.fetchCustomPlayers("EPISODE"),e=await this.fetchCustomPlayers("EMISSION",!t);await this.fetchCustomPlayers("SUGGESTION",!t&&!e)}}}}),g=["value"],S=["value"],I=["value"];function C(t,e,s,r,l,$){return a(),o(n,null,[e[1]||(e[1]=d("label",{for:"iframe-select",title:"select miniplayer"},null,-1)),d("select",{id:"iframe-select",value:t.iFrameModel,onChange:e[0]||(e[0]=i=>t.selectChange(i))},[(a(!0),o(n,null,c(t.optionsSelect,i=>(a(),o(n,{key:i.value},[i.condition?(a(),o("option",{key:0,value:i.value},m(i.name),9,S)):f("",!0)],64))),128)),(a(!0),o(n,null,c(t.customPlayersDisplay,i=>(a(),o("option",{key:i.customId,value:i.customId},m(t.$t("Custom version")+" «"+i.name+"»"),9,I))),128))],40,g)],64)}const E=v(P,[["render",C]]);export{E as default};
