import{d as p,m as c,H as f,K as m,_ as u,o as a,c as o,f as r,t as l,i as h,F as R,b as v}from"./index.js";import{f as L}from"./fetchRadioData-CeXKRHFU.js";const g=p({name:"RadioHistory",components:{},mixins:[L],emits:["updateNotListenTime"],data(){return{indexStart:0,indexNotDisplay:100}},computed:{...c(f,["playerRadio"]),playerRadioHistory(){return this.playerRadio?.history??[]}},watch:{playerRadioHistory:{deep:!0,immediate:!0,handler(){this.$nextTick(()=>{this.handleResize(0)})}}},created(){window.addEventListener("resize",()=>{this.handleResize(0)})},unmounted(){window.removeEventListener("resize",()=>{this.handleResize(0)})},mounted(){this.handleResize(0)},methods:{displayEverythingAfterIndex(t){for(let e=0;e<this.playerRadioHistory.length;e++){const i=this.$refs["history"+e][0];if(i){if(e<t&&!i.classList.contains("hid")){i.classList.add("hid");continue}e>=t&&i.classList.contains("hid")&&i.classList.remove("hid")}}},handleResize(t){const e=this.$refs.historyListContainer;if(!(e===null||!e)){this.indexStart=t,this.indexNotDisplay=this.playerRadioHistory.length,this.displayEverythingAfterIndex(t);for(let i=this.indexStart+1;i<this.playerRadioHistory.length;i++){const s=this.$refs["history"+i][0];if(!s)continue;if(i>this.indexNotDisplay&&!s.classList.contains("hid")){s.classList.add("hid");continue}const d=s.parentElement;d&&s.offsetLeft+s.clientWidth>d.clientWidth&&(this.indexNotDisplay=i,s.classList.add("hid"))}}},displayTimeItem(t){return m(t.startDate).format("HH:mm")},displayPreviousItem(t){return t.podcastId?t.title:this.displayTitle(t)}}}),x={key:0,class:"d-flex align-items-center mt-3"},H={class:"fw-bold me-3"},$={ref:"historyListContainer",class:"history-list-container"},k={class:"d-flex flex-shrink-0 align-items-end"},z={class:"me-2 hour-past-item"},D={class:"me-3"};function N(t,e,i,s,d,b){return t.playerRadioHistory.length?(a(),o("div",x,[r("div",H,l(t.$t("Previously")+":"),1),t.indexStart!==0?(a(),o("button",{key:0,class:"btn btn-transparent text-light saooti-left",onClick:e[0]||(e[0]=n=>t.handleResize(0))})):h("",!0),r("div",$,[(a(!0),o(R,null,v(t.playerRadioHistory,(n,y)=>(a(),o("div",{key:n.title,ref_for:!0,ref:"history"+y,class:"d-flex flex-shrink-0"},[r("div",k,[r("span",z,l(t.displayTimeItem(n)),1),r("span",D,l(t.displayPreviousItem(n)),1)])]))),128))],512),t.indexNotDisplay<=t.playerRadioHistory.length-1?(a(),o("button",{key:1,class:"btn btn-transparent text-light saooti-right",onClick:e[1]||(e[1]=n=>t.handleResize(t.indexNotDisplay))})):h("",!0)])):h("",!0)}const w=u(g,[["render",N]]);export{w as default};
